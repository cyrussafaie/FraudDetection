event_data <-
structure(list(time = structure(c(1512941635.15589, 1512941635.17108, 
1512941635.4593, 1512941639.81676, 1512941641.22144, 1512941642.83387, 
1512941645.05622, 1512941646.82768, 1512941647.71496, 1512941647.71496, 
1512941648.02507, 1512941653.17735, 1512941653.66243, 1512941656.42991, 
1512941659.52762, 1512941662.18485, 1512941663.08332, 1512941663.08332, 
1512941663.37951, 1512941667.56453, 1512941667.88731, 1512941669.00937, 
1512941672.60866, 1512941673.89878, 1512941674.76735, 1512941674.76735, 
1512941675.06773, 1512941680.57778, 1512941681.81448, 1512941684.41723, 
1512941689.04785, 1512941689.7361, 1512941690.63565, 1512941690.63565, 
1512941690.93081, 1512941692.40393, 1512941694.26002, 1512941695.58142, 
1512941697.38409, 1512941698.40109, 1512941699.29568, 1512941699.29568, 
1512941699.59239, 1512941702.51751, 1512941702.76215, 1512941704.10128, 
1512941707.68336, 1512941710.86299, 1512941711.75299, 1512941711.75299, 
1512941712.0526, 1512941714.48518, 1512941714.48518, 1512941717.16029, 
1512941720.27986, 1512941721.77185, 1512941722.66556, 1512941722.68084, 
1512941722.9629, 1512941725.42036, 1512941726.08554, 1512941727.48336, 
1512941730.22844, 1512941732.7438, 1512941735.30228, 1512941735.30228, 
1512941735.30228, 1512941736.05108, 1512941736.05209, 1512941737.60001, 
1512941741.05745, 1512941742.14843, 1512941743.04659, 1512941743.0476, 
1512941743.32724, 1512941749.65536, 1512941751.29964, 1512941752.9626, 
1512941755.67057, 1512941756.14357, 1512941757.06362, 1512941757.06459, 
1512941757.34819, 1512941763.59796, 1512941763.77916, 1512941764.91529, 
1512941767.21469, 1512941770.01904, 1512941770.901, 1512941770.90146, 
1512941771.20084, 1512941779.93194, 1512941781.2771, 1512941782.52395, 
1512941783.83144, 1512941785.26629, 1512941786.16883, 1512941786.16883, 
1512941786.46692, 1512941791.88702, 1512941793.73586, 1512941795.83852, 
1512941799.96924, 1512941802.06757, 1512941802.31733, 1512941802.31733, 
1512941802.52048, 1512941807.5306, 1512941807.99893, 1512941809.97794, 
1512941812.93817, 1512941813.64053, 1512941814.53572, 1512941814.53572, 
1512941814.84376, 1512941817.60547, 1512941821.85765, 1512941823.2464, 
1512941826.28568, 1512941827.56911, 1512941828.46214, 1512941828.46214, 
1512941828.77312, 1512941832.03189, 1512941832.66061, 1512941834.69666, 
1512941837.29528, 1512941838.6687, 1512941839.55001, 1512941839.55001, 
1512941839.83681, 1512941842.02854, 1512941842.33092, 1512941843.55215, 
1512941847.65134, 1512941851.50357, 1512941852.39746, 1512941852.39746, 
1512941852.68476, 1512941855.99298, 1512941856.6407, 1512941858.60819, 
1512941861.69979, 1512941864.65172, 1512941865.54036, 1512941865.54036, 
1512941865.84562, 1512941871.45084, 1512941871.76334, 1512941873.31258, 
1512941877.06161, 1512941878.06241, 1512941878.94566, 1512941878.94566, 
1512941879.26429, 1512941883.31385, 1512941883.31385, 1512941886.08704, 
1512941888.49961, 1512941890.57546, 1512941891.47753, 1512941891.48354, 
1512941891.76228, 1512941894.73963, 1512941895.38319, 1512941898.15773, 
1512941902.19884, 1512941903.15465, 1512941904.05343, 1512941904.05645, 
1512941904.34634, 1512941909.95301, 1512941910.28503, 1512941912.19202, 
1512941914.19547, 1512941916.37305, 1512941917.28886, 1512941917.28886, 
1512941917.56633, 1512941922.29926, 1512941922.95969, 1512941925.78293, 
1512941929.06464, 1512941932.94817, 1512941933.81211, 1512941933.81211, 
1512941934.11258, 1512941938.42356, 1512941939.14741, 1512941940.48247, 
1512941943.34739, 1512941945.65738, 1512941946.55001, 1512941946.55001, 
1512941946.84389, 1512941948.17163, 1512941949.2962, 1512941950.85883, 
1512941953.57511, 1512941956.73189, 1512941957.62683, 1512941957.62683, 
1512941957.92, 1512941961.11265, 1512941961.8008, 1512941962.9632, 
1512941966.3074, 1512941967.41411, 1512941968.32161, 1512941968.32161, 
1512941968.60507, 1512941973.46587, 1512941974.30711, 1512941976.08686, 
1512941979.28091, 1512941982.76456, 1512941983.65786, 1512941983.65786, 
1512941983.95242, 1512941989.09105, 1512941990.27482, 1512941993.13556, 
1512941996.34803, 1512941997.49765, 1512941998.38165, 1512941998.3826, 
1512941998.67519, 1512942002.73786, 1512942002.73786, 1512942004.08979, 
1512942006.41511, 1512942008.1778, 1512942009.08156, 1512942009.08156, 
1512942009.36144, 1512942013.2268, 1512942015.21255, 1512942017.18368, 
1512942020.38097, 1512942021.42943), class = c("POSIXct", "POSIXt"
)), visit_id = c(0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 
3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 
5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 
7L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 9L, 9L, 9L, 
9L, 9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 
11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 12L, 12L, 
12L, 12L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 14L, 14L, 14L, 
14L, 14L, 14L, 14L, 14L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 
16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 17L, 17L, 17L, 17L, 17L, 
17L, 17L, 17L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 19L, 19L, 
19L, 19L, 19L, 19L, 19L, 19L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 
20L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 22L, 22L, 22L, 22L, 
22L, 22L, 22L, 22L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 24L, 
24L, 24L, 24L, 24L, 24L, 24L, 24L, 25L, 25L, 25L, 25L, 25L, 25L, 
25L, 25L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 27L, 27L, 27L, 
27L, 27L, 27L, 27L, 27L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 
29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L), atm_signal = c("MessageID: CARD_INSERT, Value: 4319401234569720", 
"MessageID: ESD_SENSOR, Value: 991", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560848", 
"MessageID: ESD_SENSOR, Value: 1000", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234563403", 
"MessageID: ESD_SENSOR, Value: 997", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560848", 
"MessageID: ESD_SENSOR, Value: 1003", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234561661", 
"MessageID: ESD_SENSOR, Value: 1000", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234561661", 
"MessageID: ESD_SENSOR, Value: 1000", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234561661", 
"MessageID: ESD_SENSOR, Value: 1001", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234563978", 
"MessageID: ESD_SENSOR, Value: 995", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234564538", 
"MessageID: ESD_SENSOR, Value: 1003", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234562317", 
"MessageID: ESD_SENSOR, Value: 1000", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560964", 
"MessageID: ESD_SENSOR, Value: 1005", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560848", 
"MessageID: ESD_SENSOR, Value: 997", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234569890", 
"MessageID: ESD_SENSOR, Value: 1010", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560088", 
"MessageID: ESD_SENSOR, Value: 1002", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560699", 
"MessageID: ESD_SENSOR, Value: 1001", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234563978", 
"MessageID: ESD_SENSOR, Value: 1003", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234563170", 
"MessageID: ESD_SENSOR, Value: 1117", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234567921", 
"MessageID: ESD_SENSOR, Value: 1009", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234563403", 
"MessageID: ESD_SENSOR, Value: 999", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234562317", 
"MessageID: ESD_SENSOR, Value: 992", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560699", 
"MessageID: ESD_SENSOR, Value: 992", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560964", 
"MessageID: ESD_SENSOR, Value: 997", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234560088", 
"MessageID: ESD_SENSOR, Value: 995", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234567921", 
"MessageID: ESD_SENSOR, Value: 1000", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234563170", 
"MessageID: ESD_SENSOR, Value: 1002", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234562440", 
"MessageID: ESD_SENSOR, Value: 992", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234567921", 
"MessageID: ESD_SENSOR, Value: 995", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234561158", 
"MessageID: ESD_SENSOR, Value: 996", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234569857", 
"MessageID: ESD_SENSOR, Value: 998", "MessageID: PIN_INIT_START", 
"MessageID: PIN_STOP", "MessageID: AMOUNT_SEL", "MessageID: WDR_INIT_START", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED", "MessageID: CARD_INSERT, Value: 4319401234569890", 
"MessageID: ESD_SENSOR, Value: 998", "MessageID: PIN_INIT_START", 
"MessageID: WDR_INIT_START", "MessageID: AMOUNT_SEL", "MessageID: PIN_STOP", 
"MessageID: WDR_STOP", "MessageID: CARD_REMOVED"), alert_signal = c(0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0)), .Names = c("time", "visit_id", "atm_signal", 
"alert_signal"), row.names = c(NA, 240L), class = "data.frame")
result <-
structure(list(problems = structure(list(time = structure(logical(0), class = c("POSIXct", 
"POSIXt")), problem = character(0)), .Names = c("time", "problem"
), row.names = integer(0), class = "data.frame"), n_signals = 1, 
    penalty = 19.1, missed_id = integer(0)), .Names = c("problems", 
"n_signals", "penalty", "missed_id"))
